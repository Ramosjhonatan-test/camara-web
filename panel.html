<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>游니 Transmisi칩n en Vivo (HLS)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
</head>
<body class="bg-gradient-to-br from-gray-900 via-blue-900 to-black text-white min-h-screen flex flex-col">

  <header class="w-full bg-black/70 border-b-4 border-cyan-400 py-6 text-center shadow-lg">
    <h1 class="text-3xl md:text-4xl font-bold text-cyan-400 drop-shadow-lg">游꿘 Panel de Transmisi칩n en Vivo (HLS)</h1>
  </header>

  <div id="status" class="mt-6 text-center">
    <span id="offline" class="text-red-500 text-2xl font-bold">游댮 OFFLINE</span>
    <span id="online" class="hidden text-green-400 text-2xl font-bold">游릭 ONLINE</span>
  </div>

  <main class="flex-1 flex items-center justify-center w-full">
    <div class="p-4 w-full max-w-5xl">
      <video id="video" class="hidden w-full rounded-xl border-4 border-cyan-400 shadow-2xl" controls playsinline></video>
    </div>
  </main>

  <footer class="w-full bg-black/60 py-4 text-center text-gray-400 text-sm border-t border-gray-700">
    Powered by <span class="text-cyan-400 font-semibold">Render</span> | HLS + FFmpeg
  </footer>

  <script>
    const video = document.getElementById("video");
    const offline = document.getElementById("offline");
    const online = document.getElementById("online");
    const playlistURL = "https://TU-SERVICIO.onrender.com/hls/index.m3u8"; // ajusta tu dominio

    async function checkAndPlay() {
      try {
        const res = await fetch(playlistURL, { cache: "no-store" });
        if (!res.ok) throw new Error("Playlist no disponible");

        offline.classList.add("hidden");
        online.classList.remove("hidden");
        video.classList.remove("hidden");

        if (video.canPlayType('application/vnd.apple.mpegurl')) {
          video.src = playlistURL;
          await video.play().catch(() => {});
        } else if (Hls.isSupported()) {
          const hls = new Hls();
          hls.loadSource(playlistURL);
          hls.attachMedia(video);
          hls.on(Hls.Events.MANIFEST_PARSED, async () => {
            await video.play().catch(() => {});
          });
        } else {
          video.src = playlistURL;
          await video.play().catch(() => {});
        }
      } catch (e) {
        video.classList.add("hidden");
        offline.classList.remove("hidden");
        online.classList.add("hidden");
      }
    }

    setInterval(checkAndPlay, 3000);
    checkAndPlay();
  </script>
</body>
</html>
